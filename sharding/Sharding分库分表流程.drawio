<mxfile host="app.diagrams.net" modified="2023-08-20T07:01:46.269Z" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36 SLBrowser/8.0.1.4031 SLBChan/30" etag="Kf1AxbJy5A1V_6laVb9d" version="21.3.3" type="github">
  <diagram name="第 1 页" id="eEeRUdgtlv-osGGo4KyX">
    <mxGraphModel dx="934" dy="607" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="4681" pageHeight="3300" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-1" value="FrontendChannelInboundHandler" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="30" width="230" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-2" value="" style="endArrow=none;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" target="jJ9oYjbHO_kGSj09Swgw-1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="155" y="1660" as="sourcePoint" />
            <mxPoint x="170" y="290" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-3" value="channelRead" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="90" y="90" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-6" value="这个是处理client数据包的nettyhandler" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="40" y="3" width="230" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-9" value="" style="group" vertex="1" connectable="0" parent="1">
          <mxGeometry x="314" y="31" width="140" height="1630" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-4" value="ProxyStateContext" style="whiteSpace=wrap;html=1;" vertex="1" parent="jJ9oYjbHO_kGSj09Swgw-9">
          <mxGeometry width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-5" value="" style="endArrow=none;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="jJ9oYjbHO_kGSj09Swgw-9" target="jJ9oYjbHO_kGSj09Swgw-4">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="70" y="1630" as="sourcePoint" />
            <mxPoint x="130" y="260" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-19" value="execute" style="whiteSpace=wrap;html=1;" vertex="1" parent="jJ9oYjbHO_kGSj09Swgw-9">
          <mxGeometry x="10" y="70" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-10" value="" style="group" vertex="1" connectable="0" parent="1">
          <mxGeometry x="504" y="31" width="140" height="1630" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-11" value="OKProxyState" style="whiteSpace=wrap;html=1;" vertex="1" parent="jJ9oYjbHO_kGSj09Swgw-10">
          <mxGeometry width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-12" value="" style="endArrow=none;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="jJ9oYjbHO_kGSj09Swgw-10" target="jJ9oYjbHO_kGSj09Swgw-11">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="70" y="1630" as="sourcePoint" />
            <mxPoint x="130" y="260" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-20" value="execute" style="whiteSpace=wrap;html=1;" vertex="1" parent="jJ9oYjbHO_kGSj09Swgw-10">
          <mxGeometry x="10" y="80" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-28" value="new Task()" style="whiteSpace=wrap;html=1;" vertex="1" parent="jJ9oYjbHO_kGSj09Swgw-10">
          <mxGeometry x="10" y="140" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-13" value="这里是目前代理状态的管理器" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="294" y="1" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-14" value="" style="group;align=center;" vertex="1" connectable="0" parent="1">
          <mxGeometry x="714" y="31" width="175" height="1640" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-15" value="CommandExecutorTask" style="whiteSpace=wrap;html=1;" vertex="1" parent="jJ9oYjbHO_kGSj09Swgw-14">
          <mxGeometry width="140" height="30.1840490797546" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-16" value="" style="endArrow=none;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="jJ9oYjbHO_kGSj09Swgw-14" target="jJ9oYjbHO_kGSj09Swgw-15">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="70" y="1640" as="sourcePoint" />
            <mxPoint x="130" y="261.5950920245399" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-29" value="run" style="whiteSpace=wrap;html=1;" vertex="1" parent="jJ9oYjbHO_kGSj09Swgw-14">
          <mxGeometry x="20" y="150" width="100" height="20" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-32" value="executeCommand" style="whiteSpace=wrap;html=1;" vertex="1" parent="jJ9oYjbHO_kGSj09Swgw-14">
          <mxGeometry x="5" y="189" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-33" value="获取执行引擎: MySQL&lt;br&gt;获取数据包类型：查询&lt;br&gt;解析数据包&lt;br&gt;通过执行引擎和数据包生成命令执行器" style="whiteSpace=wrap;html=1;align=center;" vertex="1" parent="jJ9oYjbHO_kGSj09Swgw-14">
          <mxGeometry x="-35" y="229" width="210" height="60" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-18" value="代理正常状态处理器" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="504" y="4" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-22" value="收到mysql数据包&lt;br&gt;将协议交给Prxoy的&lt;br&gt;业务模块处理" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="184" y="76" width="130" height="60" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-30" value="将请求数据封装到命令Task&lt;br&gt;交给命令线程池处理&lt;br&gt;命令线程池单线程，不阻塞netty线程" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="584" y="111" width="220" height="60" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-31" value="mysql实际执行业务" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="714" y="4" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-34" value="" style="group" vertex="1" connectable="0" parent="1">
          <mxGeometry x="930" y="30" width="205" height="1640" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-35" value="MySQLCommandExecuteEngine" style="whiteSpace=wrap;html=1;" vertex="1" parent="jJ9oYjbHO_kGSj09Swgw-34">
          <mxGeometry width="190" height="30.1840490797546" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-36" value="" style="endArrow=none;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="jJ9oYjbHO_kGSj09Swgw-34" target="jJ9oYjbHO_kGSj09Swgw-35">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="95" y="1640" as="sourcePoint" />
            <mxPoint x="176.42857142857142" y="261.5950920245399" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-38" value="getCommandExecutor" style="whiteSpace=wrap;html=1;" vertex="1" parent="jJ9oYjbHO_kGSj09Swgw-34">
          <mxGeometry x="10" y="250" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-40" value="new MySQLComQueryPacketExecutor" style="whiteSpace=wrap;html=1;verticalAlign=top;" vertex="1" parent="jJ9oYjbHO_kGSj09Swgw-34">
          <mxGeometry x="-15" y="320" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-41" value="委托给Mysql执行器工厂&lt;br&gt;根据数据包类型创建执行器；" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="jJ9oYjbHO_kGSj09Swgw-34">
          <mxGeometry x="10" y="280" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-42" value="这里是查询包，需要创建该执行器" style="text;html=1;align=center;verticalAlign=top;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="jJ9oYjbHO_kGSj09Swgw-34">
          <mxGeometry x="-4" y="331" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-37" value="Mysql执行引擎" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="976" y="3" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-43" value="Z" style="group" vertex="1" connectable="0" parent="1">
          <mxGeometry x="1170" y="30" width="200" height="1640" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-44" value="MySQLComQueryPacketExecutor" style="whiteSpace=wrap;html=1;" vertex="1" parent="jJ9oYjbHO_kGSj09Swgw-43">
          <mxGeometry width="200" height="30.1840490797546" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-45" value="" style="endArrow=none;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="jJ9oYjbHO_kGSj09Swgw-43" target="jJ9oYjbHO_kGSj09Swgw-44">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="100" y="1640" as="sourcePoint" />
            <mxPoint x="185.71428571428575" y="261.5950920245399" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-46" value="_init&lt;br&gt;构造方法" style="whiteSpace=wrap;html=1;" vertex="1" parent="jJ9oYjbHO_kGSj09Swgw-43">
          <mxGeometry y="320" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-47" value="SQLStatement&lt;br&gt;= parseSQL()" style="whiteSpace=wrap;html=1;" vertex="1" parent="jJ9oYjbHO_kGSj09Swgw-43">
          <mxGeometry x="35" y="370" width="130" height="40" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-58" value="Mysql执行器" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="jJ9oYjbHO_kGSj09Swgw-43">
          <mxGeometry x="55" y="-30" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-60" value="创建ProxyBackendHandler&lt;br&gt;用于实际执行sql，保存结果的对象" style="whiteSpace=wrap;html=1;" vertex="1" parent="jJ9oYjbHO_kGSj09Swgw-43">
          <mxGeometry x="10" y="430" width="190" height="40" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-59" value="根据sql字面义&lt;br&gt;创建sql解析后的语法树&lt;br&gt;例如查询字段，表名，&lt;br&gt;where条件等" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="1340" y="390" width="150" height="70" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-61" value="" style="group" vertex="1" connectable="0" parent="1">
          <mxGeometry x="2010" y="40" width="320" height="1680" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-62" value="ProxyBackendHandlerFactory" style="whiteSpace=wrap;html=1;" vertex="1" parent="jJ9oYjbHO_kGSj09Swgw-61">
          <mxGeometry width="200" height="30.1840490797546" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-63" value="" style="endArrow=none;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="jJ9oYjbHO_kGSj09Swgw-61" target="jJ9oYjbHO_kGSj09Swgw-62">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="100" y="1640" as="sourcePoint" />
            <mxPoint x="185.71428571428575" y="261.5950920245399" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-26" value="ProxyBackendHandlerFactory" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1470" y="30" width="200" height="30.1840490797546" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-65" value="" style="endArrow=none;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" target="jJ9oYjbHO_kGSj09Swgw-26">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1570" y="1702.3529411764705" as="sourcePoint" />
            <mxPoint x="1620" y="200" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-66" value="执行器代理的工厂类" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="1500" y="4" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-67" value="newInstance" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1505" y="460" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-68" value="创建&lt;br&gt;SQLStatementContext" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1495" y="510" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jJ9oYjbHO_kGSj09Swgw-70" value="创建&lt;span style=&quot;text-align: center;&quot;&gt;SQLStatementContext&lt;br&gt;&lt;/span&gt;&lt;br&gt;主要做以下内容&lt;br&gt;1、重新组装的SqlStatement&lt;br&gt;因为sql字面含义不会包含表结构信息&lt;br&gt;例如 * ,这里需要填充一些表元数据信息&lt;br&gt;2、根据不同类型的SQL生成对应的上下文&lt;br&gt;方便后续根据上下文断定sql的含义；&lt;br&gt;例如是插入还是查询" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="1520" y="305" width="250" height="140" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
