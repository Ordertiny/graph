<mxfile host="app.diagrams.net" modified="2023-02-09T06:15:02.088Z" agent="5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36" version="20.8.3" etag="Y7DUQSJGTwJKuh7JS_en" type="github">
  <diagram id="bYt2CzESA14qLZL4tEW9" name="第 1 页">
    <mxGraphModel dx="1434" dy="764" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="4681" pageHeight="3300" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-1" value="rank表&lt;br&gt;100013 入围榜&lt;br&gt;100014 预选榜单&lt;br&gt;100012 省排行榜" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="60" y="110" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-2" value="入围赛&lt;br&gt;battle:team:enter:playoffs:[session]:[province]" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="220" y="110" width="260" height="40" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-3" value="战队基础信息&lt;br&gt;battle:team:simple:[battleTeamId]" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="340" width="240" height="40" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-5" value="" style="shape=image;verticalLabelPosition=bottom;labelBackgroundColor=default;verticalAlign=top;aspect=fixed;imageAspect=0;image=data:image/png,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;" vertex="1" parent="1">
          <mxGeometry x="40" y="420" width="552" height="200" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-6" value="BattleTeamService.generatePlayoffsTeam()&lt;br&gt;每周四早上0点&lt;span style=&quot;background-color: initial;&quot;&gt;会定时去找在海选时间内的城市赛配置&lt;br&gt;&lt;/span&gt;所有省(34个)循环去捞每个省区的预选榜单前10名战队&lt;br&gt;放入入选榜单中，并且更新BattleTeam对象 标记已经进入季后赛" style="whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="820" y="80" width="390" height="100" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-7" value="预选榜&lt;br&gt;battle:team:week:playoffs:[provinceId]_&quot;周一的Date&quot;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="220" y="180" width="300" height="40" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-8" value="战队活跃值 变化&lt;br&gt;BattleTeamVitalityChangeEvent&lt;br&gt;发送该事件的位置&lt;br&gt;1. battleTeamRoleLogin(BattleTeamRoleLoginEvent loginEvent) ；&lt;br&gt;移除成员时&lt;br&gt;2. removeMember(BattleTeamMemberLeaveEvent battleTeamMemberLeaveEvent)&lt;br&gt;3.&amp;nbsp;kickMember(BattleTeamKickMemberEvent battleTeamKickMemberEvent)&lt;br&gt;踢出成员时&lt;br&gt;4. battleTeamChangeProvince(BattleTeamChangeProvinceEvent battleTeamChangeProvinceEvent)&lt;br&gt;战队城市切换时&lt;br&gt;5.battleTeamFightEnd(long roleId, int mode, com.wooduan.ssjj2.common.net.proto.BattleTeam.BattleTeamLadderInfo battleTeamLadderInfo) &lt;br&gt;玩家战队结束， 在玩家收到了BattleEndEvent时会回调给社交服&lt;br&gt;6.getWeekRankReward(long roleId)&lt;br&gt;获取战队周奖励时&lt;br&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;	&lt;/span&gt;登录时，战队变成永久战队，添加战队成员&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;消费该事件逻辑&lt;br&gt;public void vitalityChange(BattleTeamVitalityChangeEvent battleTeamVitalityChangeEvent)&lt;br&gt;&lt;br&gt;&lt;div style=&quot;&quot;&gt;检测成员的活跃值是否有变化&lt;/div&gt;&lt;div style=&quot;&quot;&gt;- 如果有变化 则会去logic要玩家的基本数据和战绩数据，并且标记本周要重置&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;如果要重置 战队之前活跃度为0&lt;/div&gt;&lt;div style=&quot;&quot;&gt;当前后战队活跃度不一致时进行逻辑处理&lt;/div&gt;&lt;div style=&quot;&quot;&gt;设置战队最新活跃值&lt;/div&gt;&lt;div style=&quot;&quot;&gt;更新当周省总活跃度数据&lt;/div&gt;&lt;div style=&quot;&quot;&gt;更新当周省战队数&lt;/div&gt;&lt;div style=&quot;&quot;&gt;更新省榜值&lt;/div&gt;&lt;div style=&quot;&quot;&gt;如果战队入围季后赛，去除周榜，不然更新周榜&lt;/div&gt;" style="whiteSpace=wrap;html=1;align=left;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="820" y="230" width="440" height="550" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-9" value="&lt;br&gt;BattleTeamRoleLoginEvent&amp;nbsp; 事件生产逻辑&lt;br&gt;&lt;br&gt;1. 登录时触发&lt;br&gt;2.&amp;nbsp;检测玩家活跃是否过期&lt;br&gt;3.&amp;nbsp;添加战队成员&lt;br&gt;4. 捕捉BattleTeamChangeState 事件&lt;br&gt;-&amp;nbsp;检查战队是否过期 true:已过期 false：未过期或已为永久战队&lt;br&gt;-&amp;nbsp;管理员修改战队状态&lt;br&gt;&lt;br&gt;battleTeamRoleLogin(BattleTeamRoleLoginEvent loginEvent)&lt;br&gt;&lt;br&gt;如果战队进入季后赛。，则删除预选榜排名&lt;br&gt;检测玩家是否过期，检测段位是否有变化&lt;br&gt;如果当前时间和登录活跃值校验时间同一天&lt;br&gt;则更新日活时间并设置日活值&lt;br&gt;如果有活跃值过期或者段位变化或者非同一天 则发布&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;BattleTeamVitalityChangeEvent&lt;br&gt;&lt;br&gt;&lt;/span&gt;" style="whiteSpace=wrap;html=1;align=left;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="1500" y="120" width="460" height="260" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-10" value="省活跃*&lt;br&gt;battle:team:province:[provinceId]_周一的Date" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="220" y="290" width="260" height="40" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-11" value="省排行榜&lt;br&gt;rank:battle:team:province:[provinceId]_&quot;周一的Date&quot;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="220" y="230" width="300" height="40" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-45" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="T6L2T2Ujw4hxoBFEA6K8-12" target="T6L2T2Ujw4hxoBFEA6K8-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-12" value="玩家登录&lt;br&gt;login()" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="140" y="875" width="120" height="35" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-46" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="T6L2T2Ujw4hxoBFEA6K8-13" target="T6L2T2Ujw4hxoBFEA6K8-16">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-48" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="T6L2T2Ujw4hxoBFEA6K8-13" target="T6L2T2Ujw4hxoBFEA6K8-17">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="555" y="940" />
              <mxPoint x="470" y="940" />
              <mxPoint x="470" y="1130" />
              <mxPoint x="555" y="1130" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-13" value="调用Login&lt;br&gt;loginNotifyBattleTeamId" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="480" y="880" width="150" height="50" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-14" value="Login" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="530" y="835" width="50" height="30" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-47" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="T6L2T2Ujw4hxoBFEA6K8-16" target="T6L2T2Ujw4hxoBFEA6K8-19">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-16" value="synRoleData" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="505" y="960" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-49" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="T6L2T2Ujw4hxoBFEA6K8-17" target="T6L2T2Ujw4hxoBFEA6K8-26">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-17" value="battleTeamRoleLogin" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="492.5" y="1200" width="125" height="30" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-18" value="Logic" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="800" y="835" width="50" height="30" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-19" value="synRoleData" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="755" y="960" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-50" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="T6L2T2Ujw4hxoBFEA6K8-20" target="T6L2T2Ujw4hxoBFEA6K8-22">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-20" value="获取玩家的level，roleName，是否在线，上次登出时间，是否是大月卡" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="715" y="1027.5" width="220" height="55" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-22" value="updateBattleTeamRoleData" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1050" y="1040" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-23" value="community" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="1100" y="835" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-24" value="更新玩家的BattleTeamMember" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1067.5" y="1080" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-25" value="community" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="160" y="835" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-51" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="T6L2T2Ujw4hxoBFEA6K8-26" target="T6L2T2Ujw4hxoBFEA6K8-27">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-26" value="callCommunityRoleLogin&lt;br&gt;获取劫掠段位信息&lt;br&gt;获取劫掠匹配天梯分数据&lt;br&gt;获取爆破塞天梯分数据" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="715" y="1170" width="190" height="90" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-52" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="T6L2T2Ujw4hxoBFEA6K8-27" target="T6L2T2Ujw4hxoBFEA6K8-28">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-27" value="battleTeamRoleLogin" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1075" y="1200" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-53" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="T6L2T2Ujw4hxoBFEA6K8-28" target="T6L2T2Ujw4hxoBFEA6K8-29">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-54" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="T6L2T2Ujw4hxoBFEA6K8-28" target="T6L2T2Ujw4hxoBFEA6K8-37">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-28" value="发布了一个事件&lt;br&gt;new&amp;nbsp;BattleTeamRoleLoginEvent" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1050" y="1250" width="190" height="40" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-29" value="捕获1：battleTeamRoleLogin()" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1067.5" y="1300" width="202.5" height="40" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-30" value="异步发布了&lt;br&gt;BattleTeamDataChangeEvent事件" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1067.5" y="1350" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-31" value="如果入围了，去除周预选榜单" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1067.5" y="1400" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-32" value="检测玩家活跃度是否过期(false)" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1067.5" y="1450" width="202.5" height="40" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-33" value="checkMemberVitality()&lt;br&gt;玩家每一周只检测一次活跃度&lt;br&gt;&lt;br&gt;1. 若玩家本周已检测过则直接返回；&lt;br&gt;2. 若玩家本周没有检测过，就重置模式活跃和今日模式活跃（相当于当前已经跨档了，重置是正常的）；&lt;br&gt;3. 更新登录活跃值和登录活跃时间；&lt;br&gt;4. 设置玩家活跃度总值&lt;br&gt;&lt;br&gt;(如果需要登录标记为true)&lt;br&gt;去logic找玩家的基本信息和战绩数据" style="whiteSpace=wrap;html=1;align=left;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="1710" y="510" width="430" height="190" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-34" value="检测玩家段位是否过期" style="whiteSpace=wrap;html=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="1067.5" y="1500" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-35" value="判定当前时间和当周活跃检测时间是否一致&lt;br&gt;&lt;br&gt;如果不是同一天，则需要更新登录检测时间，重置今日模式活跃值，累计登录活跃值" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1067.5" y="1550" width="202.5" height="90" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-36" value="如果 玩家活跃度检测过期 或者 段位活跃度变更，或者登录活跃值变化，则触发战队活跃变化事件&amp;nbsp;BattleTeamVitalityChangeEvent" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1067.5" y="1652" width="240" height="70" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-37" value="捕获2：loginSendWeekReward()" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1060" y="1740" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-38" value="获取周奖励&lt;br&gt;getWeekRankReward()" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1060" y="1790" width="190" height="40" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-39" value="如果领奖时间小于上轮时间 则return" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1060" y="1840" width="210" height="40" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-40" value="加锁" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1060" y="1890" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-41" value="根据玩家触发 战队发奖" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="1260" y="1745" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-42" value="向上循环三周&lt;br&gt;给所有成员发放未领取的奖励" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1060" y="1930" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-43" value="如果lastRank大于0&lt;br&gt;重置BattleTeam的总活跃值&lt;br&gt;重置成员的活跃值" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1060" y="1980" width="210" height="50" as="geometry" />
        </mxCell>
        <mxCell id="T6L2T2Ujw4hxoBFEA6K8-44" value="玩家登录时触发" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="50" y="805" width="110" height="30" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
